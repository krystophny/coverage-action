# Test Fixtures Documentation

This directory contains test fixtures for the Code Coverage Report Action. Each fixture is designed to test specific scenarios and feature flags.

## Original Test Fixtures

### `test-branch.xml`
- **Purpose**: Tests basic branch coverage functionality
- **Coverage**: 90% line coverage, 75% branch coverage
- **Features**: Contains multiple classes with varying coverage levels

### `test-missing-lines.xml` / `test-missing-lines-2.xml`
- **Purpose**: Tests scenarios with missing lines in different patterns
- **Coverage**: 51.25% line coverage
- **Features**: Multiple files with different missing line patterns (start, end, gaps, etc.)

### `test-no-branch.xml` / `test-no-branch-2.xml`
- **Purpose**: Tests scenarios without branch coverage data
- **Coverage**: Varies by file
- **Features**: Simple line coverage without branch information

### `test-python.xml`
- **Purpose**: Tests Python-specific coverage format
- **Coverage**: 90% line coverage
- **Features**: Generated by coverage.py

## New Test Fixtures for Feature Flags

### Failure Mode Testing

#### `test-uncovered-statements-increase.xml`
- **Purpose**: Tests `uncovered-statements-increase-failure` flag
- **Coverage**: 70% line coverage
- **Scenario**: Represents increased uncovered statements (pycobertura exit code 2)
- **Expected**: Should fail when flag is enabled

#### `test-uncovered-statements-decreased.xml`
- **Purpose**: Tests `uncovered-statements-increase-failure` flag (positive case)
- **Coverage**: 90% line coverage
- **Scenario**: Represents decreased uncovered statements
- **Expected**: Should pass when flag is enabled

#### `test-new-uncovered-statements.xml`
- **Purpose**: Tests `new-uncovered-statements-failure` flag
- **Coverage**: 80% line coverage
- **Scenario**: Represents new uncovered statements with overall improvement (pycobertura exit code 3)
- **Expected**: Should fail when flag is enabled

#### `test-no-uncovered-statements.xml`
- **Purpose**: Tests `new-uncovered-statements-failure` flag (positive case)
- **Coverage**: 100% line coverage
- **Scenario**: Represents no uncovered statements
- **Expected**: Should pass when flag is enabled

#### `test-coverage-rate-reduction.xml`
- **Purpose**: Tests `coverage-rate-reduction-failure` flag
- **Coverage**: 60% line coverage
- **Scenario**: Represents reduced coverage rate compared to baseline
- **Expected**: Should fail when flag is enabled

#### `test-coverage-improved.xml`
- **Purpose**: Tests `coverage-rate-reduction-failure` flag (positive case)
- **Coverage**: 90% line coverage
- **Scenario**: Represents improved coverage rate compared to baseline
- **Expected**: Should pass when flag is enabled

### Exception Testing

#### `test-pycobertura-exception.xml`
- **Purpose**: Tests `pycobertura-exception-failure` flag in diff scenarios
- **Coverage**: 80% line coverage
- **Scenario**: Normal coverage report with diff enabled and exception flag enabled
- **Expected**: Tests that the flag is properly handled during diff operations

#### `test-exception-disabled.xml`
- **Purpose**: Tests `pycobertura-exception-failure` flag (disabled case)
- **Coverage**: 85% line coverage
- **Scenario**: Normal coverage report
- **Expected**: Should pass when flag is disabled

### Report Format Testing

#### `test-togglable-report.xml`
- **Purpose**: Tests `togglable-report` flag
- **Coverage**: 85% line coverage
- **Scenario**: Normal coverage report
- **Expected**: Should generate collapsible report format when flag is enabled

### Comprehensive Testing

#### `test-comprehensive.xml`
- **Purpose**: Tests multiple feature flags together
- **Coverage**: 75% line coverage across multiple files
- **Scenario**: Contains three files with high, medium, and low coverage
- **Features**: Tests complex scenarios with multiple files and varying coverage levels

### Baseline Testing

#### `test-baseline-main.xml`
- **Purpose**: Provides baseline coverage for diff testing
- **Coverage**: 80% line coverage
- **Scenario**: Represents the "main" branch coverage for comparison
- **Features**: Used as reference point for diff-based failure mode testing

## Test Matrix Coverage

The test matrix in `.github/workflows/test.yaml` includes test cases for:

1. **Basic functionality**: Original test fixtures with new flags set to defaults
2. **Individual failure modes**: Each failure flag tested in isolation
3. **Positive cases**: Scenarios where failure flags should NOT trigger
4. **Combined scenarios**: Multiple flags enabled together
5. **Exception handling**: Both enabled and disabled exception failure modes
6. **Report formatting**: Togglable reports with and without detailed coverage
7. **Edge cases**: Comprehensive testing with multiple files and varying coverage

## Usage

Each test fixture is used in the GitHub Actions test matrix to verify that:

- Feature flags work correctly in isolation
- Feature flags work correctly when combined
- Positive and negative scenarios are handled properly
- Exception handling works as expected
- Report formatting options function correctly

The test fixtures are designed to be realistic and cover the various scenarios that users might encounter when using the coverage action with different configurations. 